<!DOCTYPE html>
<html lang="ko">
<head>
    <!-- ê¸°ë³¸ ë©”íƒ€íƒœê·¸ -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO í•µì‹¬ ë©”íƒ€íƒœê·¸ -->
    <title>ë©”ë‰´ë¹¤ - ê³µì°¨, ë§¥ë„ë‚ ë“œ, ìŠ¤íƒ€ë²…ìŠ¤ ë©”ë‰´ ê°€ê²© ë¹„êµ | í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´íŒ</title>
    <meta name="description" content="ê³µì°¨ ë°€í¬í‹°, ë§¥ë„ë‚ ë“œ ë¹…ë§¥, ìŠ¤íƒ€ë²…ìŠ¤ ì•„ë©”ë¦¬ì¹´ë…¸ ë“± ì¸ê¸° í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ ê°€ê²©ì„ í•œëˆˆì— ë¹„êµí•˜ì„¸ìš”. ì˜µì…˜ë³„ ì‹¤ì‹œê°„ ê°€ê²© ê³„ì‚°, ìµœì‹  ë©”ë‰´ ì •ë³´ ì œê³µ.">
    <meta name="keywords" content="ê³µì°¨ ë©”ë‰´, ê³µì°¨ ê°€ê²©, ë§¥ë„ë‚ ë“œ ë©”ë‰´, ë§¥ë„ë‚ ë“œ ê°€ê²©, ìŠ¤íƒ€ë²…ìŠ¤ ë©”ë‰´, ìŠ¤íƒ€ë²…ìŠ¤ ê°€ê²©, í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´, ë©”ë‰´ ê°€ê²© ë¹„êµ, ìƒ¤ë¸Œì˜¬ë°ì´ ê°€ê²©, ì„œë¸Œì›¨ì´ ë©”ë‰´, ë©”ê°€ì»¤í”¼ ë©”ë‰´, MGCì»¤í”¼">
    
    <!-- ê²€ìƒ‰ì—”ì§„ ì œì–´ -->
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="googlebot" content="index, follow">
    <link rel="canonical" href="https://im-mini.github.io/menupan/">
    
    <!-- ì˜¤í”ˆ ê·¸ë˜í”„ (Open Graph) - ì†Œì…œ ë¯¸ë””ì–´ ê³µìœ ìš© -->
    <meta property="og:locale" content="ko_KR">
    <meta property="og:type" content="website">
    <meta property="og:title" content="ë©”ë‰´ë¹¤ - í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ ê°€ê²© ë¹„êµ">
    <meta property="og:description" content="ê³µì°¨, ë§¥ë„ë‚ ë“œ, ìŠ¤íƒ€ë²…ìŠ¤ ë“± ì¸ê¸° í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ì™€ ê°€ê²©ì„ í•œëˆˆì— ë¹„êµí•˜ì„¸ìš”.">
    <meta property="og:url" content="https://im-mini.github.io/menupan/">
    <meta property="og:site_name" content="ë©”ë‰´ë¹¤">
    
    <!-- íŠ¸ìœ„í„° ì¹´ë“œ -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ë©”ë‰´ë¹¤ - í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ ê°€ê²© ë¹„êµ">
    <meta name="twitter:description" content="ê³µì°¨, ë§¥ë„ë‚ ë“œ, ìŠ¤íƒ€ë²…ìŠ¤ ë“± ì¸ê¸° í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ì™€ ê°€ê²©ì„ í•œëˆˆì— ë¹„êµí•˜ì„¸ìš”.">
    
    <!-- ì œì‘ì ì •ë³´ -->
    <meta name="author" content="ë©”ë‰´ë¹¤">
    
    <!-- êµ¬ì¡°í™”ëœ ë°ì´í„° (JSON-LD) - ì›¹ì‚¬ì´íŠ¸ ì •ë³´ -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "ë©”ë‰´ë¹¤",
      "url": "https://im-mini.github.io/menupan/",
      "description": "í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ì™€ ê°€ê²©ì„ í•œëˆˆì— ë¹„êµí•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://im-mini.github.io/menupan/?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    
    <!-- êµ¬ì¡°í™”ëœ ë°ì´í„° - ì¡°ì§ ì •ë³´ -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "ë©”ë‰´ë¹¤",
      "url": "https://im-mini.github.io/menupan/",
      "description": "í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ ê°€ê²© ë¹„êµ ì„œë¹„ìŠ¤"
    }
    </script>
    
    <!-- ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* ë°”í…€ì‹œíŠ¸ ì• ë‹ˆë©”ì´ì…˜ */
        .bottom-sheet { 
            transform: translateY(100%); 
            transition: transform 0.3s ease-out; 
        }
        .bottom-sheet.active { 
            transform: translateY(0); 
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ */
        .no-scrollbar::-webkit-scrollbar { 
            display: none; 
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        /* ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼ */
        .category-btn.active {
            background-color: #000;
            color: #fff;
        }

        /* ì˜µì…˜ ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼ */
        .option-btn.selected {
            border-color: #dc2626;
            background-color: #fef2f2;
        }

        /* ê°€ê²© ë³€ê²½ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes priceUpdate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); color: #dc2626; }
            100% { transform: scale(1); }
        }
        .price-animate {
            animation: priceUpdate 0.3s ease-in-out;
        }

        /* ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸ */
        .highlight {
            background-color: #fef08a;
            font-weight: bold;
            padding: 0 2px;
            border-radius: 2px;
        }

        /* ì¹´ìš´íŠ¸ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .count-option {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .count-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f3f4f6;
            color: #374151;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }
        .count-btn:hover {
            background-color: #dc2626;
            color: white;
        }
        .count-btn:active {
            transform: scale(0.9);
        }
        .count-value {
            min-width: 30px;
            text-align: center;
            font-weight: bold;
        }
    </style>
    
    <!-- ë°ì´í„° -->
    <script src="data.js"></script>
</head>
<body class="bg-gray-50 font-sans">
    <!-- í—¤ë” -->
    <header class="bg-white sticky top-0 z-40 border-b shadow-sm">
        <div class="p-4">
            <h1 class="text-2xl font-extrabold text-red-600 italic flex items-center gap-2">
                <i class="fas fa-utensils"></i>
                ë©”ë‰´ë¹¤
            </h1>
            <p class="text-xs text-gray-500 mt-1">í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ ê°€ê²© ë¹„êµ</p>
            
            <!-- ê²€ìƒ‰ì°½ -->
            <div class="mt-3 relative">
                <input 
                    type="text" 
                    id="search-input" 
                    placeholder="ë©”ë‰´, ë¸Œëœë“œ, íƒœê·¸ ê²€ìƒ‰..." 
                    class="w-full px-4 py-2 pr-10 border border-gray-300 rounded-full focus:outline-none focus:border-red-500 transition-all"
                    oninput="handleSearch(this.value)"
                >
                <i class="fas fa-search absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
            </div>
            
            <!-- ì¹´í…Œê³ ë¦¬ í•„í„° -->
            <div id="category-filter" class="flex gap-2 mt-3 overflow-x-auto no-scrollbar text-sm pb-2">
                <button onclick="filterByCategory('all')" class="category-btn active bg-black text-white px-4 py-2 rounded-full shrink-0 transition-all">
                    ì „ì²´
                </button>
                <button onclick="filterByCategory('cafe')" class="category-btn bg-white border border-gray-300 px-4 py-2 rounded-full shrink-0 text-gray-700 hover:border-gray-400 transition-all">
                    â˜• ì¹´í˜
                </button>
                <button onclick="filterByCategory('fastfood')" class="category-btn bg-white border border-gray-300 px-4 py-2 rounded-full shrink-0 text-gray-700 hover:border-gray-400 transition-all">
                    ğŸ” íŒ¨ìŠ¤íŠ¸í‘¸ë“œ
                </button>
                <button onclick="filterByCategory('korean')" class="category-btn bg-white border border-gray-300 px-4 py-2 rounded-full shrink-0 text-gray-700 hover:border-gray-400 transition-all">
                    ğŸ² í•œì‹/ë·”í˜
                </button>
            </div>

            <!-- ë¸Œëœë“œ íƒ­ -->
            <div id="brand-tabs" class="flex gap-2 mt-2 overflow-x-auto no-scrollbar pb-2 hidden">
            </div>
        </div>
    </header>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main id="app" class="p-4 space-y-6 pb-24 max-w-4xl mx-auto"></main>

    <!-- ì˜¤ë²„ë ˆì´ (ë°”í…€ì‹œíŠ¸ ì—´ë¦´ ë•Œ ë°°ê²½) -->
    <div id="overlay" onclick="closeSheet()" class="fixed inset-0 bg-black/50 hidden z-50"></div>
    
    <!-- ë°”í…€ì‹œíŠ¸ (ë©”ë‰´ ìƒì„¸ ì •ë³´) -->
    <div id="bottom-sheet" class="fixed bottom-0 left-0 right-0 bg-white rounded-t-3xl z-50 bottom-sheet max-h-[85vh] overflow-y-auto">
        <div class="sticky top-0 bg-white pt-4 px-6 pb-2">
            <div class="w-12 h-1.5 bg-gray-300 rounded-full mx-auto mb-4"></div>
        </div>
        <div id="sheet-content" class="px-6 pb-6"></div>
    </div>

    <script>
        /**
         * ë©”ë‰´ë¹¤ - í”„ëœì°¨ì´ì¦ˆ ë©”ë‰´ ê°€ê²© ë¹„êµ ì„œë¹„ìŠ¤
         * ì˜µì…˜ ì„ íƒì— ë”°ë¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°€ê²©ì´ ë³€ê²½ë©ë‹ˆë‹¤
         */

        // ì „ì—­ ë³€ìˆ˜
        let currentCategory = 'all';
        let currentSearchQuery = '';
        let selectedOptions = {}; // í˜„ì¬ ì„ íƒëœ ì˜µì…˜ ì €ì¥
        let countOptions = {}; // ì¹´ìš´íŠ¸ ì˜µì…˜ ì €ì¥ (ì˜ˆ: { "ìƒ· ì¶”ê°€": 2 })

        /**
         * ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸ í•¨ìˆ˜
         * @param {string} text - ì›ë³¸ í…ìŠ¤íŠ¸
         * @param {string} query - ê²€ìƒ‰ì–´
         * @returns {string} - í•˜ì´ë¼ì´íŠ¸ ì²˜ë¦¬ëœ HTML
         */
        function highlightText(text, query) {
            if (!query) return text;
            const regex = new RegExp(`(${query})`, 'gi');
            return text.replace(regex, '<span class="highlight">$1</span>');
        }

        /**
         * ê²€ìƒ‰ í•¸ë“¤ëŸ¬
         * @param {string} query - ê²€ìƒ‰ì–´
         */
        function handleSearch(query) {
            currentSearchQuery = query.trim().toLowerCase();
            renderApp(currentCategory, currentSearchQuery);
        }

        /**
         * ë©”ë‰´ê°€ ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ë˜ëŠ”ì§€ í™•ì¸
         * @param {object} item - ë©”ë‰´ ì•„ì´í…œ
         * @param {string} brandName - ë¸Œëœë“œëª…
         * @param {string} query - ê²€ìƒ‰ì–´
         * @returns {boolean}
         */
        function isItemMatchSearch(item, brandName, query) {
            if (!query) return true;
            
            // ë©”ë‰´ëª… ë§¤ì¹­
            if (item.name.toLowerCase().includes(query)) return true;
            
            // íƒœê·¸ ë§¤ì¹­
            if (item.tags.some(tag => tag.toLowerCase().includes(query))) return true;
            
            // ë¸Œëœë“œëª… ë§¤ì¹­ (ë¸Œëœë“œëª…ì´ ë§¤ì¹­ë˜ë©´ í•´ë‹¹ ë¸Œëœë“œì˜ ëª¨ë“  ë©”ë‰´ ë…¸ì¶œ)
            if (brandName.toLowerCase().includes(query)) return true;
            
            return false;
        }

        /**
         * ë©”ì¸ ì•± ë Œë”ë§
         * @param {string} filter - ì¹´í…Œê³ ë¦¬ í•„í„° ('all', 'cafe', 'fastfood', 'korean')
         * @param {string} searchQuery - ê²€ìƒ‰ì–´
         */
        function renderApp(filter = 'all', searchQuery = '') {
            const container = document.getElementById('app');
            const brandTabs = document.getElementById('brand-tabs');
            container.innerHTML = '';
            
            // ì¹´í…Œê³ ë¦¬ë³„ë¡œ ë¸Œëœë“œ í•„í„°ë§
            let filteredFranchises = menuData.franchises.filter(brand => 
                filter === 'all' || brand.category === filter
            );

            // ê²€ìƒ‰ì–´ê°€ ìˆì„ ê²½ìš° í•„í„°ë§
            if (searchQuery) {
                filteredFranchises = filteredFranchises.map(brand => {
                    // ë¸Œëœë“œëª…ì´ ê²€ìƒ‰ì–´ì™€ ë§¤ì¹­ë˜ë©´ ëª¨ë“  ë©”ë‰´ í¬í•¨
                    if (brand.name.toLowerCase().includes(searchQuery)) {
                        return brand;
                    }
                    
                    // ì•„ë‹ˆë©´ ë§¤ì¹­ë˜ëŠ” ë©”ë‰´ë§Œ í•„í„°ë§
                    const matchedItems = brand.items.filter(item => 
                        isItemMatchSearch(item, brand.name, searchQuery)
                    );
                    
                    if (matchedItems.length > 0) {
                        return { ...brand, items: matchedItems };
                    }
                    return null;
                }).filter(brand => brand !== null);
            }

            // ë¸Œëœë“œê°€ ì—†ì„ ê²½ìš°
            if (filteredFranchises.length === 0) {
                container.innerHTML = `
                    <div class="text-center py-20">
                        <i class="fas fa-search text-gray-400 text-5xl mb-4"></i>
                        <p class="text-gray-600">${searchQuery ? 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.' : 'í•´ë‹¹ ì¹´í…Œê³ ë¦¬ì˜ ë©”ë‰´ê°€ ì—†ìŠµë‹ˆë‹¤.'}</p>
                        ${searchQuery ? '<p class="text-sm text-gray-400 mt-2">ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¡œ ì‹œë„í•´ë³´ì„¸ìš”.</p>' : ''}
                    </div>
                `;
                brandTabs.classList.add('hidden');
                return;
            }

            // ë¸Œëœë“œ íƒ­ ìƒì„± ë° í‘œì‹œ
            if (filteredFranchises.length > 1 && !searchQuery) {
                brandTabs.classList.remove('hidden');
                brandTabs.innerHTML = filteredFranchises.map(brand => `
                    <button onclick="scrollToBrand(this, 'section-${brand.id}')"
                            class="brand-tab-btn px-3 py-1.5 bg-gray-100 rounded-lg text-xs font-bold whitespace-nowrap transition-all">
                        ${brand.name}
                    </button>
                `).join('');
            } else {
                brandTabs.classList.add('hidden');
            }

            // ê° ë¸Œëœë“œ ì„¹ì…˜ ë Œë”ë§
            filteredFranchises.forEach(brand => {
                const section = document.createElement('section');
                section.id = `section-${brand.id}`;
                section.className = 'bg-white rounded-2xl shadow-sm p-5 mb-4 scroll-mt-[220px]';
                
                section.innerHTML = `
                    <!-- ë¸Œëœë“œ í—¤ë” -->
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold flex items-center gap-2">
                            <span class="w-1 h-6 bg-red-600 rounded"></span> 
                            ${highlightText(brand.name, searchQuery)}
                        </h2>
                        <span class="text-xs text-gray-400">
                            <i class="far fa-clock"></i> ${brand.last_updated} ì—…ë°ì´íŠ¸
                        </span>
                    </div>
                    
                    <!-- ë©”ë‰´ ì•„ì´í…œ ê·¸ë¦¬ë“œ -->
                    <div class="grid grid-cols-1 gap-3">
                        ${brand.items.map(item => `
                            <div onclick="openSheet('${brand.id}', '${item.id}')" 
                                 class="border border-gray-200 p-4 rounded-xl hover:border-red-300 hover:shadow-md transition-all cursor-pointer active:scale-[0.98]">
                                <div class="flex justify-between items-center">
                                    <!-- ë©”ë‰´ ì •ë³´ -->
                                    <div class="flex-1">
                                        <div class="flex gap-1.5 mb-2 flex-wrap">
                                            ${item.tags.map(tag => `
                                                <span class="text-[10px] bg-red-50 text-red-600 px-2 py-0.5 rounded-full font-bold">
                                                    #${highlightText(tag, searchQuery)}
                                                </span>
                                            `).join('')}
                                        </div>
                                        <h3 class="font-bold text-gray-900 mb-1">${highlightText(item.name, searchQuery)}</h3>
                                        <p class="text-xs text-gray-500">
                                            <i class="fas fa-sliders-h"></i> ì˜µì…˜ ì„ íƒ ê°€ëŠ¥
                                        </p>
                                    </div>
                                    
                                    <!-- ê°€ê²© ë° í™”ì‚´í‘œ -->
                                    <div class="text-right ml-4">
                                        <p class="font-black text-lg text-gray-900">
                                            ${item.base_price.toLocaleString()}ì›~
                                        </p>
                                        <i class="fa-solid fa-chevron-right text-gray-300 text-sm mt-1"></i>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;
                
                container.appendChild(section);
            });
        }

        /**
         * ë¸Œëœë“œ íƒ­ ë²„íŠ¼ í´ë¦­
         */
        function scrollToBrand(btn, sectionId) {
            // ëª¨ë“  ë²„íŠ¼ ì›ë˜ëŒ€ë¡œ
            document.querySelectorAll('.brand-tab-btn').forEach(b => {
                b.classList.replace('bg-black', 'bg-gray-100');
                b.classList.replace('text-white', 'text-gray-900');
            });
            // í´ë¦­í•œ ë²„íŠ¼ ê°•ì¡°
            btn.classList.replace('bg-gray-100', 'bg-black');
            btn.classList.add('text-white');
        
            // ì´ë™
            document.getElementById(sectionId).scrollIntoView({behavior: 'smooth', block: 'start'});
        }

        /**
         * ë°”í…€ì‹œíŠ¸ ì—´ê¸° - ë©”ë‰´ ìƒì„¸ ì •ë³´ í‘œì‹œ
         * @param {string} brandId - ë¸Œëœë“œ ID
         * @param {string} itemId - ë©”ë‰´ ì•„ì´í…œ ID
         */
        function openSheet(brandId, itemId) {
            const brand = menuData.franchises.find(b => b.id === brandId);
            const item = brand.items.find(i => i.id === itemId);
            
            // ì„ íƒëœ ì˜µì…˜ ì´ˆê¸°í™”
            selectedOptions = {};
            countOptions = {};
            
            // ê° ì˜µì…˜ ê·¸ë£¹ì—ì„œ ê¸°ë³¸ê°’ ì„¤ì •
            item.option_groups.forEach(group => {
                const defaultOption = group.options.find(opt => opt.default);
                if (defaultOption) {
                    selectedOptions[group.group_name] = defaultOption.name;
                    // count ì˜µì…˜ì´ë©´ ì´ˆê¸°ê°’ 1ë¡œ ì„¤ì •
                    if (defaultOption.count) {
                        countOptions[group.group_name] = 1;
                    }
                } else {
                    selectedOptions[group.group_name] = group.options[0].name;
                    if (group.options[0].count) {
                        countOptions[group.group_name] = 1;
                    }
                }
            });
            
            const content = document.getElementById('sheet-content');
            
            content.innerHTML = `
                <!-- ë©”ë‰´ ì œëª© -->
                <h3 class="text-2xl font-black mb-2 text-gray-900">${item.name}</h3>
                <div class="flex gap-2 mb-1">
                    ${item.tags.map(t => `<span class="text-xs text-gray-500">#${t}</span>`).join('')}
                </div>
                <p class="text-sm text-gray-500 mb-6">
                    <i class="fas fa-store"></i> ${brand.name}
                </p>
                
                <!-- ì˜µì…˜ ê·¸ë£¹ë“¤ -->
                <div class="space-y-6">
                    ${item.option_groups.map((group, groupIndex) => `
                        <div>
                            <div class="flex items-center justify-between mb-3">
                                <p class="text-sm font-bold text-gray-700">
                                    ${group.group_name}
                                    ${group.required ? '<span class="text-red-500">*</span>' : ''}
                                </p>
                            </div>
                            <div class="grid grid-cols-2 gap-2">
                                ${group.options.map((opt, optIndex) => {
                                    const isDefault = opt.default || false;
                                    const isCount = opt.count || false;
                                    
                                    if (isCount) {
                                        // ì¹´ìš´íŠ¸ ì˜µì…˜ (+ - ë²„íŠ¼)
                                        return `
                                            <div class="col-span-2 border-2 ${isDefault ? 'border-red-500 bg-red-50' : 'border-gray-200'} p-3 rounded-xl count-option">
                                                <div>
                                                    <p class="text-sm font-medium text-gray-900">${opt.name}</p>
                                                    <p class="text-xs text-gray-500 mt-1">
                                                        ${opt.extra > 0 ? '+' + opt.extra.toLocaleString() + 'ì›' : opt.extra < 0 ? opt.extra.toLocaleString() + 'ì›' : 'ê¸°ë³¸'} / ê°œë‹¹
                                                    </p>
                                                </div>
                                                <div class="flex items-center gap-3">
                                                    <button onclick="decreaseCount('${group.group_name}', '${opt.name}', ${opt.extra}, '${brandId}', '${itemId}')" class="count-btn">
                                                        <i class="fas fa-minus text-xs"></i>
                                                    </button>
                                                    <span class="count-value" id="count-${group.group_name.replace(/\s/g, '-')}">${countOptions[group.group_name] || 1}</span>
                                                    <button onclick="increaseCount('${group.group_name}', '${opt.name}', ${opt.extra}, '${brandId}', '${itemId}')" class="count-btn">
                                                        <i class="fas fa-plus text-xs"></i>
                                                    </button>
                                                </div>
                                            </div>
                                        `;
                                    } else {
                                        // ì¼ë°˜ ì˜µì…˜
                                        return `
                                            <button 
                                                onclick="selectOption('${group.group_name}', '${opt.name}', ${opt.extra}, '${brandId}', '${itemId}')"
                                                class="option-btn ${isDefault ? 'selected' : ''} border-2 border-gray-200 p-3 rounded-xl text-left hover:border-red-300 transition-all"
                                                data-group="${group.group_name}"
                                                data-option="${opt.name}">
                                                <p class="text-sm font-medium text-gray-900">${opt.name}</p>
                                                <p class="text-xs text-gray-500 mt-1">
                                                    ${opt.extra > 0 ? '+' + opt.extra.toLocaleString() + 'ì›' : opt.extra < 0 ? opt.extra.toLocaleString() + 'ì›' : 'ê¸°ë³¸'}
                                                </p>
                                            </button>
                                        `;
                                    }
                                }).join('')}
                            </div>
                        </div>
                    `).join('')}
                </div>
                
                <!-- í•˜ë‹¨ ê°€ê²© ë° êµ¬ë§¤ ë²„íŠ¼ -->
                <div class="mt-8 pt-6 border-t sticky bottom-0 bg-white">
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-xs text-gray-500 mb-1">ìµœì¢… ì˜ˆìƒ ê¸ˆì•¡</p>
                            <p id="final-price" class="text-3xl font-black text-red-600">
                                ${calculateTotalPrice(item, selectedOptions, countOptions).toLocaleString()}ì›
                            </p>
                        </div>
                        <button class="bg-red-600 text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-red-200 hover:bg-red-700 transition-colors active:scale-95">
                            <i class="fas fa-shopping-cart mr-2"></i>êµ¬ë§¤í•˜ê¸°
                        </button>
                    </div>
                </div>
            `;
            
            // ë°”í…€ì‹œíŠ¸ í‘œì‹œ
            document.getElementById('overlay').classList.remove('hidden');
            document.getElementById('bottom-sheet').classList.add('active');
        }

        /**
         * ì´ ê°€ê²© ê³„ì‚° í•¨ìˆ˜
         * @param {object} item - ë©”ë‰´ ì•„ì´í…œ
         * @param {object} selectedOpts - ì„ íƒëœ ì˜µì…˜
         * @param {object} countOpts - ì¹´ìš´íŠ¸ ì˜µì…˜
         * @returns {number} - ì´ ê°€ê²©
         */
        function calculateTotalPrice(item, selectedOpts, countOpts) {
            let totalPrice = item.base_price;
            
            item.option_groups.forEach(group => {
                const selectedOptionName = selectedOpts[group.group_name];
                const selectedOption = group.options.find(opt => opt.name === selectedOptionName);
                
                if (selectedOption) {
                    if (selectedOption.count) {
                        // ì¹´ìš´íŠ¸ ì˜µì…˜: extra * count
                        const count = countOpts[group.group_name] || 1;
                        totalPrice += selectedOption.extra * count;
                    } else {
                        // ì¼ë°˜ ì˜µì…˜: extraë§Œ ë”í•˜ê¸° (ì–‘ìˆ˜ë©´ +, ìŒìˆ˜ë©´ -)
                        totalPrice += selectedOption.extra;
                    }
                }
            });
            
            return totalPrice;
        }

        /**
         * ì¹´ìš´íŠ¸ ì¦ê°€
         */
        function increaseCount(groupName, optionName, extraPrice, brandId, itemId) {
            event.stopPropagation();
            
            countOptions[groupName] = (countOptions[groupName] || 1) + 1;
            
            // UI ì—…ë°ì´íŠ¸
            const countElement = document.getElementById(`count-${groupName.replace(/\s/g, '-')}`);
            if (countElement) {
                countElement.textContent = countOptions[groupName];
            }
            
            // ê°€ê²© ì—…ë°ì´íŠ¸
            updatePrice(brandId, itemId);
        }

        /**
         * ì¹´ìš´íŠ¸ ê°ì†Œ
         */
        function decreaseCount(groupName, optionName, extraPrice, brandId, itemId) {
            event.stopPropagation();
            
            if ((countOptions[groupName] || 1) > 1) {
                countOptions[groupName] = countOptions[groupName] - 1;
                
                // UI ì—…ë°ì´íŠ¸
                const countElement = document.getElementById(`count-${groupName.replace(/\s/g, '-')}`);
                if (countElement) {
                    countElement.textContent = countOptions[groupName];
                }
                
                // ê°€ê²© ì—…ë°ì´íŠ¸
                updatePrice(brandId, itemId);
            }
        }

        /**
         * ì˜µì…˜ ì„ íƒ í•¸ë“¤ëŸ¬ - ì‹¤ì‹œê°„ ê°€ê²© ê³„ì‚°
         * @param {string} groupName - ì˜µì…˜ ê·¸ë£¹ ì´ë¦„
         * @param {string} optionName - ì„ íƒëœ ì˜µì…˜ ì´ë¦„
         * @param {number} extraPrice - ì¶”ê°€ ê¸ˆì•¡
         * @param {string} brandId - ë¸Œëœë“œ ID
         * @param {string} itemId - ë©”ë‰´ ì•„ì´í…œ ID
         */
        function selectOption(groupName, optionName, extraPrice, brandId, itemId) {
            // ì„ íƒëœ ì˜µì…˜ ì—…ë°ì´íŠ¸
            selectedOptions[groupName] = optionName;
            
            // UI ì—…ë°ì´íŠ¸ - ê°™ì€ ê·¸ë£¹ ë‚´ ë‹¤ë¥¸ ë²„íŠ¼ë“¤ ì„ íƒ í•´ì œ
            const allButtons = document.querySelectorAll(`[data-group="${groupName}"]`);
            allButtons.forEach(btn => btn.classList.remove('selected'));
            
            // í˜„ì¬ ì„ íƒí•œ ë²„íŠ¼ í™œì„±í™”
            const selectedButton = document.querySelector(`[data-group="${groupName}"][data-option="${optionName}"]`);
            if (selectedButton) {
                selectedButton.classList.add('selected');
            }
            
            // ê°€ê²© ì—…ë°ì´íŠ¸
            updatePrice(brandId, itemId);
        }

        /**
         * ê°€ê²© ì—…ë°ì´íŠ¸ í•¨ìˆ˜
         */
        function updatePrice(brandId, itemId) {
            const brand = menuData.franchises.find(b => b.id === brandId);
            const item = brand.items.find(i => i.id === itemId);
            
            const totalPrice = calculateTotalPrice(item, selectedOptions, countOptions);
            
            // ê°€ê²© ì—…ë°ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜
            const priceElement = document.getElementById('final-price');
            priceElement.classList.add('price-animate');
            priceElement.textContent = totalPrice.toLocaleString() + 'ì›';
            
            // ì• ë‹ˆë©”ì´ì…˜ ì œê±° (ì¬ì‚¬ìš©ì„ ìœ„í•´)
            setTimeout(() => {
                priceElement.classList.remove('price-animate');
            }, 300);
        }

        /**
         * ë°”í…€ì‹œíŠ¸ ë‹«ê¸°
         */
        function closeSheet() {
            document.getElementById('overlay').classList.add('hidden');
            document.getElementById('bottom-sheet').classList.remove('active');
            selectedOptions = {};
            countOptions = {};
        }

        /**
         * ì¹´í…Œê³ ë¦¬ í•„í„°ë§
         * @param {string} category - ì¹´í…Œê³ ë¦¬ ('all', 'cafe', 'fastfood', 'korean')
         */
        function filterByCategory(category) {
            currentCategory = category;
            renderApp(category, currentSearchQuery);
            
            // ì¹´í…Œê³ ë¦¬ ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
            const buttons = document.querySelectorAll('.category-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // í˜ì´ì§€ ë¡œë“œì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            renderApp(currentCategory, currentSearchQuery);
        });

        // ESC í‚¤ë¡œ ë°”í…€ì‹œíŠ¸ ë‹«ê¸°
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeSheet();
            }
        });
    </script>
</body>
</html>
